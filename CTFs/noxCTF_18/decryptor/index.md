# Decryptor

### [~$ cd ..](../)

> N = 140165355674296399459239442258630641339281917770736077969396713192714338090714726890918178888723629353043167144351074222216025145349467583141291274172356560132771690830020353668100494447956043734613525952945037667879068512918232837185005693504551982611886445611514773529698595162274883360353962852882911457919
> c = 86445915530920147553767348020686132564453377048106098831426077547738998373682256014690928256854752252580894971618956714013602556152722531577337080534714463052378206442086672725486411296963581166836329721403101091377505869510101752378162287172126836920825099014089297075416142603776647872962582390687281063434
> e = 65537
> nc chal.noxale.com 4242 

The statements tells us that an oracle can decrypt everything we want except the given ciphertext. This attack is well-known and really easy. Indeed, 
we only have to send something like `c * pow(k, e)`, because raised to the power of `d`, it gives us:

> ```
> m' = (c * pow(k, e))^d mod n
>    = c^d * pow(k, e)^d mod n
>	 = m * pow(k, ed) mod n
> 	 = m * k mod n
> ```

last thing to do is to divide the result by `k`. We choosed `k=2`

> ```python
> >>> c = 86445915530920147553767348020686132564453377048106098831426077547738998373682256014690928256854752252580894971618956714013602556152722531577337080534714463052378206442086672725486411296963581166836329721403101091377505869510101752378162287172126836920825099014089297075416142603776647872962582390687281063434
> >>> N = 140165355674296399459239442258630641339281917770736077969396713192714338090714726890918178888723629353043167144351074222216025145349467583141291274172356560132771690830020353668100494447956043734613525952945037667879068512918232837185005693504551982611886445611514773529698595162274883360353962852882911457919
> >>> c = c * pow(2, 65537)
> >>> c = c % N #don't forget to apply the modulus!
> >>> hex(c)
>	'0x4f0c793f06e344694d87be6a69ff9e6f8952f727762053a835c3a5d5a7b7936bd40c1d032cd4f7e00612e2ce6928efed48d81c694d2c2d0697181a9f7a01169a2b72c62e190b6964d66078705b56589d6f8ddb707c98f05d195eaa1bf336eca09eb1fe25bb3dfbc47a15fb056ed9f61b84965093fb800e59bc9868a9466a497L'
> ```

Send it to the oracle:

> ```sh
> $ nc chal.noxale.com 4242 
>	Please insert your ciphertext to decrypt in hex form:
>	4f0c793f06e344694d87be6a69ff9e6f8952f727762053a835c3a5d5a7b7936bd40c1d032cd4f7e00612e2ce6928efed48d81c694d2c2d0697181a9f7a01169a2b72c62e190b6964d66078705b56589d6f8ddb707c98f05d195eaa1bf336eca09eb1fe25bb3dfbc47a15fb056ed9f61b84965093fb800e59bc9868a9466a497
>	dcdef086a88cf660ea6ee6da68e46e66c8fa
> ```

And finally:

> ```python
>> >>> 0xdcdef086a88cf660ea6ee6da68e46e66c8fa/2
>	9620282652174541515632189048064332019229821L
> >>> hex(_)
>	'0x6e6f784354467b307537736d34723733647dL'
> >>> _[2:-1].decode('hex')
>	'noxCTF{0u7sm4r73d}'
> ```
