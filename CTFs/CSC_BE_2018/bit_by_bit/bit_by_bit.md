# Bit by bit

The goal here is to break a RSA cipher, given a 7640 bits public key. A hint is given: computers are not necessary (really ?!)
> ```
> N =73988951474993672246701442195266800676762320587272057816178038663978127487265295683183319124941139471943795829148740005840589768262076139366345346967497305165328313110313508047226075781534645177839433054083497359097960476095803952363588597696672596950313988799367334915722581954583704066623448556821823471507919229696699269622586762677260948450228498197114870305662199331628378394655378068551806540721130914607134812539329419054378251556422011252033996341895973455404735016606838344204064099568960737203561570211669641689510141027019500710299174799994660342497299798559146643442129120939896939336193714240040793530225935123072491605896020495412119596847217613232101895548744561073007189471952033669751824425403907512085604391263303434459570002927478998155689638159154700864892191653803454830684687321372566190329408840429408713116200437960864551301797946885124236329216630665063087451845414478997574048022269436267229129388307428845682341672260349590843835731004017642071378921963264867461052276298395104752675380752040797537132118500665574058488741554608528292654464505846503949619556458624390014011881999028271759532639783299851890711972696083280327749015616639859034322525200713659926135718882355733894705765575326596018023969684093778551024278784462185606720985221220947996204525443554987572732602258212153027882080487367566435865936757373528080228020449986536689798383598995556286678404615942934707441136140579731877170171509900388891640995773119243735902945327222961264075808815830854272026028007424212121394324241138304802777852253512177926200242961627079021789902458446363101942632649128320189287362105581935498761441392329928328921676372345836310719155694475436229414030321927572863555317292739057705753552097681209848691370929288600607669143338974837342332571193997548539597465433402261157120333756391825328438933677129634869562708915868392337697207882875666100482491771479231300511255339087137218196063192012126878957703703941790558441876512604431156577105370673876572420247794369124043034630418380081061748228276448993462371707215409133953326375006491680018653408325504695156359917303322266488826153333602747043119188292331155877153120784819528225275107863349051923244570302728624247271248515497206341166245395747295057850386007789190948736729198397524486235374908734015612751293863428097
> e = 65537
> c = 45640760405377882191999274544549085926916411262402458391664845340511173120907946234403915171770228003986485157295196743563059310905809768769864010478173565023442689365993155434706214663956342011780630102133388867237452079837550975453389436052724722960497200393476482582130876647734660242242856951459949111879736093344675382791868212188405262920665971446004781661738248156161570398231265826201308449497255223945602181392235135613520176797569342137864076160753808115107611458870350987090674469484778300158939171705935619742939284816397205610694988596913831236926536379774840298831302644738142262387095607599586809920650152871343889935926983560484733588916036863416277247613536537428788800180984112042436946123726706125029018127390868670822188768915101211589536022375061940064247588113090630745145452194250837854860347486258839136383482138656714773642651103599524170445243734924979378994302978048227729758280928284383131966342914000198421397735727240430967648710239446080473604930760228569377910460130281366394942429364245453624698421114230804980815622741676971425920006350426075190937751130546969560368822936223007781232817046696338345196280207531962555960174792049681089291478105987403835106433507947611341738351677822192033992286122038862370991774843070297874698283645057888743583081301246229751470047201798613012951811019035719914163718524007961304950294037038409811771492169555187476435761176244026958206306552376682197953253764222448613642891386449561388267247610558233249801363165468240016943417020858814340922566133893883086894875059943608404154903621534050033451718096908414511289246956728106956735255442304021272617087946932742052584515376413279595450507483783446498266279366528915869084934945710647522937978277087351829500185965037121526843818777950451168917342155722772996862854394713182126514190616372228216391915508334347123586940221211152114956325332055176176203034529873146590489012176121359310686911909507519393466718299350869036641284213433795066499601914002180170672451575659002656554999598159643254490861995943095429532956637622252987607655534122637425911970717802928452331653460556761255259934879479683373316327268328743764382121616597546906360051142841337420713202250774325069961203028130716722553124340587851579155466228177854166444111498428734040712706113501467871520752532514774
> ```

# Factorization

The first thing we did was to check on factordb.com if the modulus was already known, but it was not the case. Because of the name of the challenge, we decided to translate the modulus in binary and we got a very interesting number:
> ```
> 11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111101111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001
> ```

A long serie of 1s, a zero, a serie of 1s, a serie of 0s and a final 1. We were pretty sure that it was not common, and that there was a way to easily factorize.
We knew that it was probably the product of two Mersenne's numbers, which are powers of 2 minus 1. Let's take an example with small numbers:
> ```
> 0b1111111111	: 1023 
> 0b11111111	: 255
> 0b111111101100000001 : 1023 * 255
> ```
Quite interesting !
Because of the name of the challenge, we simply wrote a Python script to find if N could be factorized with two Mersenne's numbers:
> ```Python
>N = 73988951474993672246701442195266800676762320587272057816178038663978127487265295683183319124941139471943795829148740005840589768262076139366345346967497305165328313110313508047226075781534645177839433054083497359097960476095803952363588597696672596950313988799367334915722581954583704066623448556821823471507919229696699269622586762677260948450228498197114870305662199331628378394655378068551806540721130914607134812539329419054378251556422011252033996341895973455404735016606838344204064099568960737203561570211669641689510141027019500710299174799994660342497299798559146643442129120939896939336193714240040793530225935123072491605896020495412119596847217613232101895548744561073007189471952033669751824425403907512085604391263303434459570002927478998155689638159154700864892191653803454830684687321372566190329408840429408713116200437960864551301797946885124236329216630665063087451845414478997574048022269436267229129388307428845682341672260349590843835731004017642071378921963264867461052276298395104752675380752040797537132118500665574058488741554608528292654464505846503949619556458624390014011881999028271759532639783299851890711972696083280327749015616639859034322525200713659926135718882355733894705765575326596018023969684093778551024278784462185606720985221220947996204525443554987572732602258212153027882080487367566435865936757373528080228020449986536689798383598995556286678404615942934707441136140579731877170171509900388891640995773119243735902945327222961264075808815830854272026028007424212121394324241138304802777852253512177926200242961627079021789902458446363101942632649128320189287362105581935498761441392329928328921676372345836310719155694475436229414030321927572863555317292739057705753552097681209848691370929288600607669143338974837342332571193997548539597465433402261157120333756391825328438933677129634869562708915868392337697207882875666100482491771479231300511255339087137218196063192012126878957703703941790558441876512604431156577105370673876572420247794369124043034630418380081061748228276448993462371707215409133953326375006491680018653408325504695156359917303322266488826153333602747043119188292331155877153120784819528225275107863349051923244570302728624247271248515497206341166245395747295057850386007789190948736729198397524486235374908734015612751293863428097
>c = 45640760405377882191999274544549085926916411262402458391664845340511173120907946234403915171770228003986485157295196743563059310905809768769864010478173565023442689365993155434706214663956342011780630102133388867237452079837550975453389436052724722960497200393476482582130876647734660242242856951459949111879736093344675382791868212188405262920665971446004781661738248156161570398231265826201308449497255223945602181392235135613520176797569342137864076160753808115107611458870350987090674469484778300158939171705935619742939284816397205610694988596913831236926536379774840298831302644738142262387095607599586809920650152871343889935926983560484733588916036863416277247613536537428788800180984112042436946123726706125029018127390868670822188768915101211589536022375061940064247588113090630745145452194250837854860347486258839136383482138656714773642651103599524170445243734924979378994302978048227729758280928284383131966342914000198421397735727240430967648710239446080473604930760228569377910460130281366394942429364245453624698421114230804980815622741676971425920006350426075190937751130546969560368822936223007781232817046696338345196280207531962555960174792049681089291478105987403835106433507947611341738351677822192033992286122038862370991774843070297874698283645057888743583081301246229751470047201798613012951811019035719914163718524007961304950294037038409811771492169555187476435761176244026958206306552376682197953253764222448613642891386449561388267247610558233249801363165468240016943417020858814340922566133893883086894875059943608404154903621534050033451718096908414511289246956728106956735255442304021272617087946932742052584515376413279595450507483783446498266279366528915869084934945710647522937978277087351829500185965037121526843818777950451168917342155722772996862854394713182126514190616372228216391915508334347123586940221211152114956325332055176176203034529873146590489012176121359310686911909507519393466718299350869036641284213433795066499601914002180170672451575659002656554999598159643254490861995943095429532956637622252987607655534122637425911970717802928452331653460556761255259934879479683373316327268328743764382121616597546906360051142841337420713202250774325069961203028130716722553124340587851579155466228177854166444111498428734040712706113501467871520752532514774
>e = 65537
>
>for i in range(1,len(bin(N))-2, 1):
>	p = pow(2,i)-1
>	q = N/p
>	if p*q == N and p != 1 and q != 1:
>		print 'P: %d, Q: %d' % (p,q)
>		break
> ```
An answer appeared very quickly:
> ```
> P: 259117086013202627776246767922441530941818887553125427303974923161874019266586362086201209516800483406550695241733194177441689509238807017410377709597512042313066624082916353517952311186154862265604547691127595848775610568757931191017711408826252153849035830401185072116424747461823031471398340229288074545677907941037288235820705892351068433882986888616658650280927692080339605869308790500409503709875902119018371991620994002568935113136548829739112656797303241986517250116412703509705427773477972349821676443446668383119322540099648994051790241624056519054483690809616061625743042361721863339415852426431208737266591962061753535748892894599629195183082621860853400937932839420261866586142503251450773096274235376822938649407127700846077124211823080804139298087057504713825264571448379371125032081826126566649084251699453951887789613650248405739378594599444335231188280123660406262468609212150349937584782292237144339628858485938215738821232393687046160677362909315071,
> Q: 285542542228279613901563566102164008326164238644702889199247456602284400390600653875954571505539843239754513915896150297878399377056071435169747221107988791198200988477531339214282772016059009904586686254989084815735422480409022344297588352526004383890632616124076317387416881148592486188361873904175783145696016919574390765598280188599035578448591077683677175520434074287726578006266759615970759521327828555662781678385691581844436444812511562428136742490459363212810180276096088111401003377570363545725120924073646921576797146199387619296560302680261790118132925012323046444438622308877924609373773012481681672424493674474488537770155783006880852648161513067144814790288366664062257274665275787127374649231096375001170901890786263324619578795731425693805073056119677580338084333381987500902968831935913095269821311141322393356490178488728982288156282600813831296143663845945431144043753821542871277745606447858564159213328443580206422714694913091762716447041689678070096773590429808909616750452927258000843500344831628297089902728649981994387647234574276263729694848304750917174186181130688518792748622612293341368928056634384466646326572476167275660839105650528975713899320211121495795311427946254553305387067821067601768750977866100460014602138408448021225053689054793742003095722096732954750721718115531871310231057902608580607
> ```
Indeed, if we write these 2 numbers in binary notation, we can see that they are written only with 1.

# Decrypt
Decryption is then very easy. We modified our [script](rsa.py) in this way:
> ```Python
>from Crypto.Util import number
>
>N = 73988951474993672246701442195266800676762320587272057816178038663978127487265295683183319124941139471943795829148740005840589768262076139366345346967497305165328313110313508047226075781534645177839433054083497359097960476095803952363588597696672596950313988799367334915722581954583704066623448556821823471507919229696699269622586762677260948450228498197114870305662199331628378394655378068551806540721130914607134812539329419054378251556422011252033996341895973455404735016606838344204064099568960737203561570211669641689510141027019500710299174799994660342497299798559146643442129120939896939336193714240040793530225935123072491605896020495412119596847217613232101895548744561073007189471952033669751824425403907512085604391263303434459570002927478998155689638159154700864892191653803454830684687321372566190329408840429408713116200437960864551301797946885124236329216630665063087451845414478997574048022269436267229129388307428845682341672260349590843835731004017642071378921963264867461052276298395104752675380752040797537132118500665574058488741554608528292654464505846503949619556458624390014011881999028271759532639783299851890711972696083280327749015616639859034322525200713659926135718882355733894705765575326596018023969684093778551024278784462185606720985221220947996204525443554987572732602258212153027882080487367566435865936757373528080228020449986536689798383598995556286678404615942934707441136140579731877170171509900388891640995773119243735902945327222961264075808815830854272026028007424212121394324241138304802777852253512177926200242961627079021789902458446363101942632649128320189287362105581935498761441392329928328921676372345836310719155694475436229414030321927572863555317292739057705753552097681209848691370929288600607669143338974837342332571193997548539597465433402261157120333756391825328438933677129634869562708915868392337697207882875666100482491771479231300511255339087137218196063192012126878957703703941790558441876512604431156577105370673876572420247794369124043034630418380081061748228276448993462371707215409133953326375006491680018653408325504695156359917303322266488826153333602747043119188292331155877153120784819528225275107863349051923244570302728624247271248515497206341166245395747295057850386007789190948736729198397524486235374908734015612751293863428097
>c = 45640760405377882191999274544549085926916411262402458391664845340511173120907946234403915171770228003986485157295196743563059310905809768769864010478173565023442689365993155434706214663956342011780630102133388867237452079837550975453389436052724722960497200393476482582130876647734660242242856951459949111879736093344675382791868212188405262920665971446004781661738248156161570398231265826201308449497255223945602181392235135613520176797569342137864076160753808115107611458870350987090674469484778300158939171705935619742939284816397205610694988596913831236926536379774840298831302644738142262387095607599586809920650152871343889935926983560484733588916036863416277247613536537428788800180984112042436946123726706125029018127390868670822188768915101211589536022375061940064247588113090630745145452194250837854860347486258839136383482138656714773642651103599524170445243734924979378994302978048227729758280928284383131966342914000198421397735727240430967648710239446080473604930760228569377910460130281366394942429364245453624698421114230804980815622741676971425920006350426075190937751130546969560368822936223007781232817046696338345196280207531962555960174792049681089291478105987403835106433507947611341738351677822192033992286122038862370991774843070297874698283645057888743583081301246229751470047201798613012951811019035719914163718524007961304950294037038409811771492169555187476435761176244026958206306552376682197953253764222448613642891386449561388267247610558233249801363165468240016943417020858814340922566133893883086894875059943608404154903621534050033451718096908414511289246956728106956735255442304021272617087946932742052584515376413279595450507483783446498266279366528915869084934945710647522937978277087351829500185965037121526843818777950451168917342155722772996862854394713182126514190616372228216391915508334347123586940221211152114956325332055176176203034529873146590489012176121359310686911909507519393466718299350869036641284213433795066499601914002180170672451575659002656554999598159643254490861995943095429532956637622252987607655534122637425911970717802928452331653460556761255259934879479683373316327268328743764382121616597546906360051142841337420713202250774325069961203028130716722553124340587851579155466228177854166444111498428734040712706113501467871520752532514774
>e = 65537
>
>p = 0
>q = 0
>
>for i in range(1,len(bin(N))-2, 1):
>	p = pow(2,i)-1
>	q = N/p
>	if p*q == N and p != 1 and q != 1:
>		print 'P: %d, Q: %d' % (p,q)
>		break
>
>phi = (p-1)*(q-1)
>d = number.inverse(e, phi)
>print hex(pow(c, d, N))[2:-1].decode('hex')
> ```
**CSCBE{7h3_l4unch_c0d3_15_c0vf3f3}** (oh yes, it was about Donald Trump's Twitter account!)
